<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Selective Highlight Container Packing 3D</title>
  <style>
    body { margin: 0; overflow: hidden; background: white; display: flex; }
    canvas { display: block; flex: 1; }
    #sidebar {
      width: 200px;
      background: #f0f0f0;
      overflow-y: auto;
      padding: 10px;
      font-family: sans-serif;
      font-size: 14px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="sidebar"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
<script>
  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0xffffff);

  const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 50000);
  camera.position.set(10000, 5000, 10000);

  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth - 200, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  const controls = new THREE.OrbitControls(camera, renderer.domElement);
  const light = new THREE.AmbientLight(0xffffff, 1);
  scene.add(light);

  const allBoxes = [];
  const boxMetaMap = new Map();

  function clearScene() {
    while (scene.children.length > 0) {
      scene.remove(scene.children[0]);
    }
    scene.add(light);
  }

  function drawSampleBoxes() {
    clearScene();
    const sampleData = [
      { model: 'FQ803', color: '#FF0000' },
      { model: 'FQ825', color: '#00FF00' },
      { model: 'FQ832', color: '#0000FF' },
      { model: 'F1627', color: '#FFA500' }
    ];

    const spacing = 1000;
    let xPos = 0;

    sampleData.forEach((item, index) => {
      const group = new THREE.Group();

      for (let i = 0; i < 5; i++) {
        const box = new THREE.Mesh(
          new THREE.BoxGeometry(500, 500, 500),
          new THREE.MeshStandardMaterial({ color: item.color, transparent: true, opacity: 1 })
        );
        box.position.set(xPos, 250 + i * 550, 0);

        group.add(box);

        const edges = new THREE.EdgesGeometry(box.geometry);
        const wire = new THREE.LineSegments(edges, new THREE.LineBasicMaterial({ color: 0x000000 }));
        wire.position.copy(box.position);

        group.add(wire);

        allBoxes.push(box);
        boxMetaMap.set(box, item.model);
      }

      scene.add(group);
      xPos += spacing;
    });

    generateSidebar(sampleData);
  }

  function generateSidebar(items) {
    const sidebar = document.getElementById('sidebar');
    sidebar.innerHTML = `<strong>Filter Items:</strong><br><br>`;

    items.forEach(item => {
      const label = document.createElement('label');
      label.innerHTML = `
        <input type="checkbox" value="${item.model}" onchange="filterBoxes()"> ${item.model}
      `;
      sidebar.appendChild(label);
    });
  }

  function filterBoxes() {
    const selected = Array.from(document.querySelectorAll('#sidebar input:checked'))
                          .map(input => input.value);

    allBoxes.forEach(box => {
      const model = boxMetaMap.get(box);
      if (selected.length === 0 || selected.includes(model)) {
        box.material.opacity = 1.0;
      } else {
        box.material.opacity = 0.05;
      }
    });
  }

  window.filterBoxes = filterBoxes;

  function animate() {
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene, camera);
  }

  drawSampleBoxes();
  animate();
</script>

</body>
</html>
